from time import sleep
from random import randint,random
import asyncio

all_potatos = {x:randint(1,50)for x in 'abcd'}

async def take_potatos(num):
    count = 0
    while True:
        if len(all_potatos) ==0:
            await ask_for_potato()
        else:
            potato = all_potatos.popitem()

            yield potato
            count +=1
            if count == num:
                break
    
async def buy_potatos():
    bucket = []
    async for p in take_potatos(20):
        bucket.append(p)
        print(bucket)

async def ask_for_potato():
    await asyncio.sleep(3)
    all_potatos.update({x:randint(1,20) for x  in "临兵斗者皆阵列在前"})

def main():
    loop=asyncio.get_event_loop()
    loop.run_until_complete(asyncio.wait([buy_potatos()])  )
    loop.close()

if __name__ == "__main__":
    main()


"""

[('d', 11)]
[('d', 11), ('c', 49)]
[('d', 11), ('c', 49), ('b', 47)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16), ('临', 6)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16), ('临', 6), ('前', 20)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16), ('临', 6), ('前', 20), ('在', 11)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16), ('临', 6), ('前', 20), ('在', 11), ('列', 20)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16), ('临', 6), ('前', 20), ('在', 11), ('列', 20), ('阵', 8)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16), ('临', 6), ('前', 20), ('在', 11), ('列', 20), ('阵', 8), ('皆', 2)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16), ('临', 6), ('前', 20), ('在', 11), ('列', 20), ('阵', 8), ('皆', 2), ('者', 19)]
[('d', 11), ('c', 49), ('b', 47), ('a', 44), ('前', 14), ('在', 14), ('列', 9), ('阵', 10), ('皆', 5), ('者', 2), ('斗', 12), ('兵', 16), ('临', 6), ('前', 20), ('在', 11), ('列', 20), ('阵', 8), ('皆', 2), ('者', 19), ('斗', 7)]
"""

